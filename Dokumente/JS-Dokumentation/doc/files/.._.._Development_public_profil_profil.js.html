<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>../../Development/public/profil/profil.js - Muliplayer Tetris</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.8.0pr2/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <script src="http://yui.yahooapis.com/combo?3.8.0pr2/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
            <h1><a href="../index.html"><img src="../assets/css/logo.png">Muliplayer Tetris: ../../Development/public/profil/profil.js</a></h1>
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: 0.9</em>
        </div>
    </div>
    <div class="yui3-g">

        <div id="sidebar" class="yui3-u">
            <div id="modules" class="sidebox">
    <div class="hd">
        <h2 class="no-toc">Modules</h2>
    </div>
    <div class="bd">
        <ul>
            
                <li><a href="../modules/controller.html">controller</a>
                
                </li>
            
                <li><a href="../modules/display.html">display</a>
                
                </li>
            
                <li><a href="../modules/global.html">global</a>
                
                </li>
            
                <li><a href="../modules/server.html">server</a>
                
                </li>
            
        </ul>
    </div>
</div>

<div id="classes" class="sidebox">
    <div class="hd">
        <h2 class="no-toc">Classes</h2>
    </div>
    <div class="bd">
        <ul>
            
                <li><a href="../classes/controller.Auswahl.html">controller.Auswahl</a></li>
            
                <li><a href="../classes/controller.Chat.html">controller.Chat</a></li>
            
                <li><a href="../classes/controller.Controller.html">controller.Controller</a></li>
            
                <li><a href="../classes/display.AfterGame.html">display.AfterGame</a></li>
            
                <li><a href="../classes/display.Display.html">display.Display</a></li>
            
                <li><a href="../classes/display.Lounge.html">display.Lounge</a></li>
            
                <li><a href="../classes/display.MyAudio.html">display.MyAudio</a></li>
            
                <li><a href="../classes/display.Spieler.html">display.Spieler</a></li>
            
                <li><a href="../classes/global.API_SCHEMA.html">global.API_SCHEMA</a></li>
            
                <li><a href="../classes/global.BUTTON.html">global.BUTTON</a></li>
            
                <li><a href="../classes/global.BUTTONTYPE.html">global.BUTTONTYPE</a></li>
            
                <li><a href="../classes/global.CONFIG.html">global.CONFIG</a></li>
            
                <li><a href="../classes/global.GAME_EVENT.html">global.GAME_EVENT</a></li>
            
                <li><a href="../classes/global.LIST_EVENT.html">global.LIST_EVENT</a></li>
            
                <li><a href="../classes/global.pre_defs.html">global.pre_defs</a></li>
            
                <li><a href="../classes/global.Util.html">global.Util</a></li>
            
                <li><a href="../classes/server.Api.html">server.Api</a></li>
            
                <li><a href="../classes/server.Chat.html">server.Chat</a></li>
            
                <li><a href="../classes/server.CommandLine.html">server.CommandLine</a></li>
            
                <li><a href="../classes/server.Controller.html">server.Controller</a></li>
            
                <li><a href="../classes/server.Database.html">server.Database</a></li>
            
                <li><a href="../classes/server.Display.html">server.Display</a></li>
            
                <li><a href="../classes/server.Game.html">server.Game</a></li>
            
                <li><a href="../classes/server.games.AbstractGame.html">server.games.AbstractGame</a></li>
            
                <li><a href="../classes/server.games.SpielAufZeit.html">server.games.SpielAufZeit</a></li>
            
                <li><a href="../classes/server.games.SpielAufZeit.Block.html">server.games.SpielAufZeit.Block</a></li>
            
                <li><a href="../classes/server.games.SpielAufZeit.Blockelement.html">server.games.SpielAufZeit.Blockelement</a></li>
            
                <li><a href="../classes/server.games.SpielAufZeit.Spieler.html">server.games.SpielAufZeit.Spieler</a></li>
            
                <li><a href="../classes/server.Main.html">server.Main</a></li>
            
                <li><a href="../classes/server.Profil.html">server.Profil</a></li>
            
                <li><a href="../classes/server.Router.html">server.Router</a></li>
            
                <li><a href="../classes/server.RouterChache.html">server.RouterChache</a></li>
            
                <li><a href="../classes/server.Server.html">server.Server</a></li>
            
                <li><a href="../classes/server.SpielTyp.html">server.SpielTyp</a></li>
            
        </ul>
    </div>
</div>










<div id="fileTree" class="sidebox">
    <div class="hd">
        <h2 class="no-toc">Files</h2>
    </div>
    <div class="bd">
        <ul><li>../<ul><li>../<ul><li>Development/<ul><li>public/<ul><li>controller/<ul><li><a href="../files/.._.._Development_public_controller_.Modul.js.html">.Modul.js</a></li><li><a href="../files/.._.._Development_public_controller_Auswahl.js.html">Auswahl.js</a></li><li><a href="../files/.._.._Development_public_controller_Chat.js.html">Chat.js</a></li><li><a href="../files/.._.._Development_public_controller_Controller.js.html">Controller.js</a></li></ul></li><li>display/<ul><li><a href="../files/.._.._Development_public_display_.Modul.js.html">.Modul.js</a></li><li><a href="../files/.._.._Development_public_display_AfterGame.js.html">AfterGame.js</a></li><li><a href="../files/.._.._Development_public_display_Display.js.html">Display.js</a></li><li><a href="../files/.._.._Development_public_display_Lounge.js.html">Lounge.js</a></li><li><a href="../files/.._.._Development_public_display_MyAudio.js.html">MyAudio.js</a></li><li><a href="../files/.._.._Development_public_display_Spieler.js.html">Spieler.js</a></li></ul></li><li>global/<ul><li><a href="../files/.._.._Development_public_global_.Modul.js.html">.Modul.js</a></li><li><a href="../files/.._.._Development_public_global_Util.js.html">Util.js</a></li><li><a href="../files/.._.._Development_public_global_api-schema.js.html">api-schema.js</a></li><li><a href="../files/.._.._Development_public_global_config.js.html">config.js</a></li><li><a href="../files/.._.._Development_public_global_db.js.html">db.js</a></li><li><a href="../files/.._.._Development_public_global_enum_controller_buttons.js.html">enum_controller_buttons.js</a></li><li><a href="../files/.._.._Development_public_global_events.js.html">events.js</a></li></ul></li><li>highscore/<ul><li><a href="../files/.._.._Development_public_highscore_highscore.js.html">highscore.js</a></li></ul></li><li>profil/<ul><li><a href="../files/.._.._Development_public_profil_profil.js.html">profil.js</a></li></ul></li><li>server/<ul><li><a href="../files/.._.._Development_public_server_Api.js.html">Api.js</a></li><li><a href="../files/.._.._Development_public_server_Chat.js.html">Chat.js</a></li><li><a href="../files/.._.._Development_public_server_CommandLine.js.html">CommandLine.js</a></li><li><a href="../files/.._.._Development_public_server_Controller.js.html">Controller.js</a></li><li><a href="../files/.._.._Development_public_server_Database.js.html">Database.js</a></li><li><a href="../files/.._.._Development_public_server_Display.js.html">Display.js</a></li><li><a href="../files/.._.._Development_public_server_Game.js.html">Game.js</a></li><li>Games/<ul><li><a href="../files/.._.._Development_public_server_Games_AbstractGame.js.html">AbstractGame.js</a></li><li>SpielAufZeit/<ul><li><a href="../files/.._.._Development_public_server_Games_SpielAufZeit_.Modul.js.html">.Modul.js</a></li><li><a href="../files/.._.._Development_public_server_Games_SpielAufZeit_Block.js.html">Block.js</a></li><li><a href="../files/.._.._Development_public_server_Games_SpielAufZeit_Blockelement.js.html">Blockelement.js</a></li><li><a href="../files/.._.._Development_public_server_Games_SpielAufZeit_SpielAufZeit.js.html">SpielAufZeit.js</a></li><li><a href="../files/.._.._Development_public_server_Games_SpielAufZeit_Spieler.js.html">Spieler.js</a></li></ul></li></ul></li><li><a href="../files/.._.._Development_public_server_Main.js.html">Main.js</a></li><li><a href="../files/.._.._Development_public_server_Profil.js.html">Profil.js</a></li><li><a href="../files/.._.._Development_public_server_Router.js.html">Router.js</a></li><li><a href="../files/.._.._Development_public_server_RouterChache.js.html">RouterChache.js</a></li><li><a href="../files/.._.._Development_public_server_Server.js.html">Server.js</a></li><li><a href="../files/.._.._Development_public_server_SpielTyp.js.html">SpielTyp.js</a></li></ul></li></ul></li></ul></li></ul></li></ul></li></ul>
    </div>
</div>



        </div>

        <div id="main" class="yui3-u">
            <div class="content"><h4>../../Development/public/profil/profil.js</h4>

<pre class="code prettyprint linenums">
&quot;use strict&quot;;

var actPage = 0;
var maxEntry = CONFIG.ProfilListe.maxEntry;
var pages = CONFIG.ProfilListe.pages;

function getAllProfile(act){
	var von = (act*maxEntry)+1;
	var bis = (maxEntry-1) + von;
	$.getJSON(&#x27;/api/profil/&#x27; + von + &#x27;-&#x27; + bis, function(data){ //+ von + &#x27;/&#x27; + bis
		actPage = act;
		var head = &quot;&lt;tr&gt;&lt;th&gt;ID&lt;/th&gt;&lt;th&gt;Name&lt;/th&gt;&lt;th&gt;Punkte&lt;/th&gt;&lt;th&gt; gesetze Steine &lt;/th&gt;&lt;th style=&#x27;width:120px;&#x27;&gt; &lt;/th&gt;&lt;th style=&#x27;width:140px;&#x27;&gt; &lt;/th&gt;&lt;/tr&gt;&quot;;
		$(&#x27;#ProfilTable&#x27;).html(head);
		var i;
		var tr = &#x27;&#x27;
		for(i = 0; i &lt; data.length; i++){
			tr += &#x27;&lt;tr&gt;&#x27;;
			tr += replaceString(&#x27;&lt;td&gt;?&lt;/td&gt;&#x27;, data[i].ProfilID);
			tr += replaceString(&#x27;&lt;td&gt;?&lt;/td&gt;&#x27;, data[i].Name);
			tr += replaceString(&#x27;&lt;td&gt;?&lt;/td&gt;&#x27;, data[i].Punkte);
			tr += replaceString(&#x27;&lt;td&gt;?&lt;/td&gt;&#x27;, data[i].GesetzteBloecke);
			tr += replaceArray(&#x27;&lt;td&gt;&lt;a href=&quot;?&quot;&gt;??&lt;/a&gt;&lt;/td&gt;&#x27;, [data[i].ProfilID, &#x27;Details anzeigen&#x27;]);
			tr += replaceArray(&#x27;&lt;td&gt;&lt;a href=&quot;/display/#profil/?&quot;&gt;??&lt;/a&gt;&lt;/td&gt;&#x27;,[data[i].ProfilID, &#x27;als Display folgen&#x27;]);
			tr += &#x27;&lt;/tr&gt;&#x27;;
		}
		$(&#x27;#ProfilTable&#x27;).append(tr);
		getPager();
	});
}


/**
 * Erstellt den Pager.
 *
 * @method getPager
 */
function getPager(){
	$.getJSON(&#x27;/api/profil/length/&#x27;, function(data){
		var pagination = Math.round(data.count/maxEntry) -1;
		var i, j, range, text = &#x27;&#x27;;
		var link = &#x27;&lt;li ??&gt;&lt;a href=&quot;javascript:;&quot; onclick=&quot;getAllProfile(?)&quot;&gt;???&lt;/a&gt;&lt;/li&gt;&#x27;;
		if(1 &lt;= pagination){
			i = 1;
			if (actPage != 0){
				i = actPage - pages +1;
				if (i &lt; 1)
					i = 1;
				text += replaceArray(link, [0, &#x27;&#x27;, &#x27;erste Seite&#x27;]);
				text += replaceArray(link, [actPage-1, &#x27;&#x27;, &#x27;vorherige Seite&#x27;]);
				if (1 &lt; i)
					text += &#x27;&lt;li&gt;&lt;p&gt;...&lt;/p&gt;&lt;/li&gt;&#x27;;	 
			}
			while(i &lt; actPage+1){
				text += replaceArray(link, [i-1, &#x27;&#x27;, i]);
				i += 1;
			}
			text += replaceArray(link, [actPage, &#x27;class=&quot;on&quot;&#x27;, actPage+1]);
			while(i &lt; (actPage + pages +1) &amp;&amp; i &lt;= pagination){
				i += 1;
				text += replaceArray(link, [i-1, &#x27;&#x27;, i]);
			}
			if (i &lt;= pagination)
				text += &#x27;&lt;li&gt;&lt;p&gt;...&lt;/p&gt;&lt;/li&gt;&#x27;;
			if (actPage &lt; pagination){
				text += replaceArray(link, [actPage+1, &#x27;&#x27;, &#x27;n&amp;auml;chste Seite&#x27;]);
				text += replaceArray(link, [pagination, &#x27;&#x27;, &#x27;letzte Seite&#x27;]);
			}
		}
		$(&#x27;#pager&#x27;).html(text);
	});
}

function replaceString(link, value){
	return link.replace(&#x27;?&#x27;, value);
}


/**
 * Ersetzt die Vorkommen von &#x27;?&#x27; in link den Werten in array
 *
 * @method replaceArray
 * @param  {String}	  beinhaltet mehrere &#x27;?&#x27;, die ersetzt werden sollen
 * @param  {Array}	  die String in value werden für &#x27;?&#x27; eingefügt
 */
function replaceArray(link, array){
	if (array.length == 3)
		return link.replace(&#x27;???&#x27;, array[2]).replace(&#x27;??&#x27;, array[1]).replace(&#x27;?&#x27;, array[0]);
	else if (array.length == 2)
		return link.replace(&#x27;??&#x27;, array[1]).replace(&#x27;?&#x27;, array[0]);

}

function getOneProfil(id){
	$.getJSON(&#x27;/api/profil/&#x27;+id, function(data){
			var tr = &#x27;&lt;tr&gt;&#x27;
			tr += &#x27;&lt;td&gt;&#x27; + data.ProfilID + &#x27;&lt;/td&gt;&#x27;;
			tr += &#x27;&lt;td&gt;&#x27; + data.Name + &#x27; &lt;/td&gt;&#x27;;
			tr += &#x27;&lt;td&gt;&#x27; + Util.formatTimestamp(data.AnmeldeDatum) + &#x27;&lt;/td&gt;&#x27;;
			tr += &#x27;&lt;td&gt;&#x27; + Util.formatTimestamp(data.LetzteAnmeldung, true, &quot;nie&quot;) + &#x27;&lt;/td&gt;&#x27;;
			tr += &#x27;&lt;td&gt;&#x27; + data.Punkte + &#x27; &lt;/td&gt;&#x27;;
			$(&#x27;#DetailProfilTable&#x27;).append(tr);
			
			$(&quot;#profilName&quot;).text(data.Name);
	});
	
	$.getJSON(&#x27;/api/profil/&#x27;+id+&quot;/spiele&quot;, function(data){
		var i;
		for(i = 0; i &lt; data.length; i++){
			var tr = &#x27;&lt;tr&gt;&#x27;
			//tr += &#x27;&lt;td&gt;&#x27; + data[i].SpielID + &#x27;&lt;/td&gt;&#x27;;
			//tr += &#x27;&lt;td&gt;&#x27; + data[i].punkte + &#x27; &lt;/td&gt;&#x27;;
			tr += &#x27;&lt;td&gt;&#x27; + data[i].SpielTypBezeichnung + &#x27;&lt;/td&gt;&#x27;;
			tr += &#x27;&lt;td&gt;&#x27; + Util.formatTimestamp(data[i].Datum, true) + &#x27;&lt;/td&gt;&#x27;;
			tr += &#x27;&lt;td&gt;&#x27; + Util.secondsToReadable(data[i].Dauer) + &#x27; &lt;/td&gt;&#x27;;
			tr += &#x27;&lt;td&gt; &lt;a href=&quot;/display#spiel/&#x27; + data[i].SpielID + &#x27;&quot;&gt;Spieldetails Anzeigen »&lt;/a&gt;&lt;/td&gt;&#x27;;
			
			http://localhost:1337735
			$(&#x27;#SpielTabelle&#x27;).append(tr);
		}
	});
}

$(window).ready(function(){
	var id = parseInt(window.location.pathname.replace(/\/$/g,&quot;&quot;).split( &#x27;/&#x27; ).pop());
	if(id){
		getOneProfil(id);
	}else{
		getAllProfile(actPage);
		window.setInterval(&quot;getAllProfile(actPage)&quot;, (CONFIG.ProfilListe.interval * 1000));
	}
});

</pre>

</div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/js/tabs.js"></script>
</body>
</html>
